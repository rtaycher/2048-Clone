{"version":3,"sources":["game.ts"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["/**\n * Created by roma on 5/22/16.\n */\n\nenum Direction {\n    Left,\n    Right,\n    Up,\n    Down\n}\n\nfunction arraysEqualHack(arr1, arr2) {\n    return JSON.stringify(arr1)==JSON.stringify(arr2);\n}\n\nfunction is_truthy(val) {\n    if (val) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction sum(array) {\n    return array.reduce((acc, x) => {\n        if (x) {\n            return x + acc\n        } else {\n            return acc;\n        }\n    }, 0);\n}\n\n//CC 3.0 Attribution http://jaketrent.com/post/addremove-classes-raw-javascript/ by Jake Trent\nfunction hasClass(el, className) {\n    if (el.classList)\n        return el.classList.contains(className)\n    else\n        return !!el.className.match(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)'))\n}\n\nfunction addClass(el, className) {\n    if (el.classList)\n        el.classList.add(className)\n    else if (!hasClass(el, className)) el.className += \" \" + className\n}\n\nfunction removeClass(el, className) {\n    if (el.classList)\n        el.classList.remove(className)\n    else if (hasClass(el, className)) {\n        var reg = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)')\n        el.className=el.className.replace(reg, ' ')\n    }\n}\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nconst colors = [\"White\", \"LightGrey\",\"DarkGrey\", \"Yellow\", \"LightSalmon\",\"Orangered\", \"Gold\", \"Red\", \"LightCoral\", \"RoyalBlue\", \"Black\", \"Blue\", \"Black\", \"LimeGreen\", \"MistyRose\",\"Brown\",\"Purple\"];\nclass Board {\n\n    constructor(x_size, y_size) {\n        this.array = [];\n        this.x_size = x_size;\n        this.y_size = y_size;\n    }\n\n    get_score(): number {\n        return sum(this.array);\n    }\n\n    get_index(x:number, y:number) {\n        return (y * this.x_size) + x;\n    }\n\n    add_new_number() {\n        if (this.array.filter(x => !!x).length === this.x_size * this.y_size) {\n            throw Error(\"board is full\");\n        }\n\n        let index = getRandomIntInclusive(0, this.x_size * this.y_size - 1);\n        while (this.array[index]) {\n            index = getRandomIntInclusive(0, this.x_size * this.y_size - 1);\n        }\n        this.array[index] = 2;\n\n    }\n\n    try_move(direction, x, y) {\n        let old_location_index = 0;\n        let new_location_index = 0;\n        if (direction === Direction.Left) {\n            if (x === 0) {\n                return;\n            }\n            old_location_index = this.get_index(x, y);\n            new_location_index = this.get_index(x - 1, y);\n        } else if (direction === Direction.Right) {\n            if (x === this.x_size - 1) {\n                return;\n            }\n            old_location_index = this.get_index(x, y);\n            new_location_index = this.get_index(x + 1, y);\n        } else if (direction === Direction.Up) {\n            if (y === 0) {\n                return;\n            }\n            old_location_index = this.get_index(x, y);\n            new_location_index = this.get_index(x, y - 1);\n        } else if (direction === Direction.Down) {\n            if (y === this.y_size - 1) {\n                return;\n            }\n            old_location_index = this.get_index(x, y);\n            new_location_index = this.get_index(x, y + 1);\n        }\n        let value_at_old_location = this.array[old_location_index];\n        let value_at_new_location = this.array[new_location_index];\n        if (value_at_old_location === value_at_new_location) {\n            this.array[old_location_index] = null;\n            this.array[new_location_index] = value_at_old_location + value_at_new_location;\n        } else if (!value_at_new_location) {\n            this.array[old_location_index] = null;\n            this.array[new_location_index] = value_at_old_location;\n        }\n    }\n    game_is_won() {\n        return this.array.some(x => x >= 2048);\n    }\n    can_make_move() {\n        let old_array = this.array.slice();\n\n        this.shift_board(Direction.Up)\n        this.shift_board(Direction.Down)\n        this.shift_board(Direction.Left)\n        this.shift_board(Direction.Right)\n        if (arraysEqualHack(this.array, old_array))\n        {\n            return false;\n        }\n        this.array = old_array;\n\n        return true;\n    }\n    shift_board(direction) {\n\n        if (direction === Direction.Left) {\n            for (let y = 0; y < this.y_size; y++) {\n                for (let x = this.x_size - 1; x > 0; x--) {\n                    console.info(`Left x,y: ${x} ${y}`);\n                    this.try_move(direction, x, y);\n                }\n            }\n        } else if (direction === Direction.Right) {\n            for (let y = 0; y < this.y_size; y++) {\n                for (let x = 0; x < this.x_size; x++) {\n                    console.info(`Right x,y: ${x} ${y}`);\n                    this.try_move(direction, x, y);\n                }\n            }\n        } else if (direction === Direction.Up) {\n            for (let y = this.y_size-1; y > 0; y--) {\n                for (let x = 0; x < this.x_size; x++) {\n                    console.info(`Up x,y: ${x} ${y}`);\n                    this.try_move(direction, x, y);\n                }\n            }\n        } else if (direction === Direction.Down) {\n            for (let y = 0; y < this.y_size; y++) {\n                for (let x = 0; x < this.x_size; x++) {\n                    console.info(`Down x,y: ${x} ${y}`);\n                    this.try_move(direction, x, y);\n                }\n            }\n        }\n    }\n\n    draw() {\n        let game = document.getElementById(\"game\");\n        // delete old nodes\n        while (game.firstChild) {\n            game.removeChild(game.firstChild);\n        }\n\n        const x_size = 4;\n        const y_size = 4;\n        let i = 0;\n        let rows = [];\n        let actual_width = 0;\n\n        for (let y = 0; y < y_size; y++) {\n            let row = document.createElement(\"div\");\n            row.className = \"game-row\";\n            // row.style.height = `${(100 / y_size).toString()}%`;\n            rows.push(row);\n\n            for (let x = 0; x < x_size; x++) {\n                let cell = document.createElement(\"div\");\n                cell.className = \"game-cell\";\n                cell.innerHTML = (this.array[this.get_index(x, y)] || \"\").toString();\n                if(this.array[this.get_index(x, y)]) {\n                    removeClass(cell, \"transparent\");\n                } else {\n                    addClass(cell, \"transparent\");\n                }\n                if (this.get_index(x, y)) {\n                    cell.style.backgroundColor = colors[this.array[this.get_index(x, y)]];\n                }\n                row.appendChild(cell);\n                i++;\n            }\n            game.appendChild(row);\n        }\n        document.getElementById(\"game-score\").innerHTML = this.get_score().toString();\n        if (this.game_is_won() ) {\n            if (this.can_make_move()) {\n                document.getElementById(\"game-status\").innerHTML = \"Game Won!\";\n            } else {\n                document.getElementById(\"game-status\").innerHTML = \"Game Won! No more moves can be made\";\n            }\n        } else if (!this.can_make_move()) {\n            document.getElementById(\"game-status\").innerHTML = \"No More moves can be made. Game Lost!\";\n        }\n        else{\n            document.getElementById(\"game-status\").innerHTML = \"\";\n        }\n    }\n\n    points: number;\n    array: number[];\n    x_size: number;\n    y_size: number;\n}\n\nfunction input_handling(event) {\n    if (!window.board.game_won) {\n        switch (event.keyCode) {\n            case 72: // h\n            case 65: // a\n            case 37: // Left Arrow\n                window.board.shift_board(Direction.Left);\n                console.log(\"Left key is pressed\");\n                window.board.add_new_number();\n                break;\n            case 75: // k\n            case 87: // w\n            case 38: // Up Arrow\n                window.board.shift_board(Direction.Up);\n                console.log(\"Up key is pressed\");\n                window.board.add_new_number();\n                break;\n            case 76: // l\n            case 68: // d\n            case 39:  // Right Arrow\n                window.board.shift_board(Direction.Right);\n                console.log(\"Right key is pressed\");\n                window.board.add_new_number();\n                break;\n            case 74: // j\n            case 83: // s\n            case 40: // Down Arrow\n                window.board.shift_board(Direction.Down);\n                console.log(\"Down key is pressed\");\n                window.board.add_new_number();\n                break;\n        }\n    }\n    window.board.draw();\n}\n\ninterface Window { board:any;\n}\n\n// from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random\n// Returns a random integer between min (included) and max (included)\n// Using Math.round() will give you a non-uniform distribution!\nfunction getRandomIntInclusive(min:number, max:number) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction new_game() {\n    let x_size = 4;\n    let y_size = 4;\n\n    window.board = new Board(x_size, y_size) || {};\n    window.board.add_new_number();\n    window.board.add_new_number();\n    window.board.draw();\n}\nfunction main() {\n    document.onkeydown = input_handling;\n    new_game();\n}\n\n\nmain();\n"],"sourceRoot":"/source/"}